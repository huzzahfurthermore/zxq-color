<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üñºÔ∏è</text></svg>">
  <title> Accessible Sindome Art Colorizer</title>
	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Code+Pro">
	<style>
.color { display: inline-block; margin-right: 10px; margin-bottom: 5px; width: 50px; height: 20px; border-right: 1px solid #fff; border-left: 1px solid #fff; cursor: pointer; }
body { background-color: black; color: #aaa; font-family: "Source Code Pro"; }
#editor-container { position: relative; width: 100%; height: 150px; margin-bottom: 5px; }
#editor-container, #textInput {}
#textInput { position: relative; width: 100%; height: 30vh; margin: 0; padding: 5px; font-family: "Source Code Pro", monospace; font-size: 14px; line-height: 1.25; background-color: transparent; color: #aaa; white-space: pre-wrap; border: 1px solid #ccc; overflow: scroll; box-sizing: border-box; }
textarea { resize: none; }
button{padding: 5px;background: #555;color: #ccc;border: #333; margin-top:5px;margin-bottom: 5px;cursor: pointer; }
button:hover{background:#777;}
	</style>
</head>

<body onbeforeunload="return myFunction()" onload="colorBuild()">
<search><input type="search" id="searchBar" name="Search Bar" placeholder="Search the colors‚Ä¶" aria-label="Search for colors" onInput="colorBuild()"/></search>
	<div id="colorPalette"></div>
		<textarea id="textInput" placeholder="Enter text..." oninput="updateOutput();"></textarea>
<button id="copy">Copy Usable Code to Clipboard</button><button id="convert" style="margin-left:10px;" >Convert Codes to Descriptive Format</button>
	<div id="output" style="white-space:break-spaces;outline:none;caret-color:transparent;">Colored text will appear here</div>

	<script>
	  function myFunction() { return "Input is not saved."; }
		const colorDict = [["no","#no"],["Black","#000000"],["Red","#800000"],["Green","#008000"],["Yellow","#808000"],["Blue","#000080"],["Magenta","#800080"],["Cyan","#008080"],["White","#c0c0c0"],["Grey","#808080"],["Red Blood Bright","#ff0000"],["Green Bright","#00ff00"],["Yellow Bright","#ffff00"],["Blue Bright","#0000ff"],["Magenta Bright","#ff00ff"],["Blue Cyan Light","#00ffff"],["Grey White","#ffffff"],["Black","#000000"],["Blue Navy","#00005f"],["Blue Dark","#000087"],["Blue Mostly Dark","#0000af"],["Blue Medium Dark","#0000d7"],["Blue Bright","#0000ff"],["Green Forest Mostly Dark","#005f00"],["Blue Silver","#005f5f"],["Blue Deep Sky Dark","#005f87"],["Blue Deep Sky Medium","#005faf"],["Blue Dodger Dark","#005fd7"],["Blue Dodger Medium","#005fff"],["Green Forest Dark","#008700"],["Green Autum Dark","#00875f"],["Blue Turquoise","#008787"],["Blue Sky Dark","#0087af"],["Blue Sky Medium","#0087d7"],["Blue Dodger","#0087ff"],["Green Forest Medium Dark","#00af00"],["Green Jade","#00af5f"],["Cyan Dark","#00af87"],["Blue Sea Green","#00afaf"],["Blue Brilliant Medium","#00afd7"],["Blue Brilliant","#00afff"],["Green Forest Medium","#00d700"],["Green Forest Light","#00d75f"],["Green Forst Blue","#00d787"],["Green Forest Cyan","#00d7af"],["Cyan Turqouise","#00d7d7"],["Blue Light","#00d7ff"],["Green Bright","#00ff00"],["Green Spring Bright","#00ff5f"],["Green Spring Matte","#00ff87"],["Green Spring Medium","#00ffaf"],["Blue Cyan Medium","#00ffd7"],["Blue Cyan Light","#00ffff"],["Brown Chocolate","#5f0000"],["Magenta Dark","#5f005f"],["Magenta Purple","#5f0087"],["Magenta Purple Dark","#5f00af"],["Magenta Purple Medium","#5f00d7"],["Magenta Purple Light","#5f00ff"],["Orange Brown","#5f5f00"],["Grey Deep","#5f5f5f"],["Grey Purple Deep","#5f5f87"],["Blue Slate Deep","#5f5faf"],["Blue Slate Dark","#5f5fd7"],["Blue Royal","#5f5fff"],["Green Olive","#5f8700"],["Green Sea Deep","#5f875f"],["Green Turquoise Pale","#5f8787"],["Blue Steel Deep","#5f87af"],["Blue Steel Dark","#5f87d7"],["Blue Cornflower","#5f87ff"],["Green Chartreuse Deep","#5faf00"],["Green Sea Deep Dark","#5faf5f"],["Blue Cadet","#5faf87"],["Blue Cadet Light","#5fafaf"],["Blue Sky","#5fafd7"],["Blue Steel","#5fafff"],["Green Chartreuse Dark","#5fd700"],["Green Pale","#5fd75f"],["Green Sea Dark","#5fd787"],["Blue Aquamarine","#5fd7af"],["Blue Turquoise Medium","#5fd7d7"],["Blue Steel Light","#5fd7ff"],["Green Chartreuse Medium","#5fff00"],["Green Sea","#5fff5f"],["Green Sea Medium","#5fff87"],["Green Sea Light","#5fffaf"],["Blue Aquamarine Light","#5fffd7"],["Grey Slate Dark","#5fffff"],["Red Dark","#870000"],["Magenta Pink Deep","#87005f"],["Magenta Dark Pink","#870087"],["Magenta Dark Purple","#8700af"],["Magenta Dark Violet","#8700d7"],["Magenta Purple Slate","#8700ff"],["Brown","#875f00"],["Brown Pink","#875f5f"],["Magenta Purple Plum","#875f87"],["Magenta Purple Plum Medium","#875faf"],["Magenta Purple Lavendar","#875fd7"],["Blue Slate","#875fff"],["Yellow Brown","#878700"],["Yellow Wheat Dark","#87875f"],["Grey Wheat","#878787"],["Grey Light Slate","#8787af"],["Magenta Purple Blue","#8787d7"],["Magenta Purple Slate Light","#8787ff"],["Yellow Wheat Medium","#87af00"],["Green Olive Matte","#87af5f"],["Brown Sea Green","#87af87"],["Blue Sky Light Silver","#87afaf"],["Blue Sky Light Silver Bright","#87afd7"],["Blue Sky Purple","#87afff"],["Green Chartreuse","#87d700"],["Green Olive Light","#87d75f"],["Green Pale Medium","#87d787"],["Blue Sea Green Medium","#87d7af"],["Grey Slate Medium","#87d7d7"],["Blue Sky Pale","#87d7ff"],["Green Chartreuse Bright","#87ff00"],["Green Light","#87ff5f"],["Green Light Medium","#87ff87"],["Green Pale Light","#87ffaf"],["Green Aquamarine","#87ffd7"],["Blue Slate Grey","#87ffff"],["Red Sector","#af0000"],["Red Pink Deep","#af005f"],["Magenta Violet Medium","#af0087"],["Magenta Violet Light","#af00af"],["Magenta Violet Dark","#af00d7"],["Magenta Purple Posh","#af00ff"],["Orange Blood","#af5f00"],["Red Indian Magenta","#af5f5f"],["Magenta Hot Pink","#af5f87"],["Magenta Orchid Dark","#af5faf"],["Magenta Orchid Medium","#af5fd7"],["Magenta Medium Alt","#af5fff"],["Yellow Golden Rod Dark","#af8700"],["Brown Salmon","#af875f"],["Brown Rosy","#af8787"],
["Brown Grey","#af87af"],["Magenta Purple Medium Matte","#af87d7"],["Magenta Purple Bright","#af87ff"],["Yellow Golden Dark","#afaf00"],["Yellow Khaki Dark","#afaf5f"],["Yellow Navajo White","#afaf87"],["Yellow Navajo White Light","#afafaf"],["Brown Steel Blue","#afafd7"],["Magenta Steel Blue","#afafff"],["Yellow Green Light","#afd700"],["Green Olive Medium","#afd75f"],["Yellow Green Sea","#afd787"],["Grey Green Sea","#afd7af"],["Brown Cyan","#afd7d7"],["Blue Periwinkle","#afd7ff"],["Green Yellow","#afff00"],["Green Yellow Light","#afff5f"],["Green Neon Matte","#afff87"],["Green Slate","#afffaf"],["Blue Slate Light","#afffd7"],["Blue Pale Turqouise","#afffff"],["Red Blood","#d70000"],["Red Cherry","#d7005f"],["Red Ruby","#d70087"],["Magenta Ruby","#d700af"],["Magenta Ruby Bright","#d700d7"],["Magenta Ruby Light","#d700ff"],["Orange Blood Light","#d75f00"],["Red Indian Medium","#d75f5f"],["Red Pink Hot Dark","#d75f87"],["Red Pink Hot","#d75faf"],["Magenta Orchid Deep","#d75fd7"],["Magenta Orchid Bright","#d75fff"],["Orange Medium","#d78700"],["Red Salmon","#d7875f"],["Red Pink Matte","#d78787"],["Red Pink Dark","#d787af"],["Magenta Plum","#d787d7"],["Magenta Violet","#d787ff"],["Yellow Golden","#d7af00"],["Brown Beige","#d7af5f"],["Brown Tan","#d7af87"],["Red Misty Rose","#d7afaf"],["Magenta Thistle","#d7afd7"],["Magenta Plum Medium","#d7afff"],["Yellow Light","#d7d700"],["Yellow Khaki","#d7d75f"],["Yellow Golden Light","#d7d787"],["Yellow Golden Very Light","#d7d7af"],["Grey Pink","#d7d7d7"],["Grey Slate Blue","#d7d7ff"],["Yellow Golden Bright","#d7ff00"],["Yellow Golden Medium","#d7ff5f"],["Green Olive Dark","#d7ff87"],["Green Light Sea","#d7ffaf"],["Green Honey Dew","#d7ffd7"],["Cyan Light Grey","#d7ffff"],["Red Blood Bright","#ff0000"],["Red Blood Matte","#ff005f"],["Red Deep Pink","#ff0087"],["Magenta Deep Pink","#ff00af"],["Magenta Bright Light","#ff00d7"],["Magenta Bright","#ff00ff"],["Red Orange","#ff5f00"],["Red Indian","#ff5f5f"],["Red Indian Pink","#ff5f87"],["Red Hot Pink","#ff5faf"],["Red Hot Pink Bright","#ff5fd7"],["Magenta Orchid","#ff5fff"],["Orange Dark","#ff8700"],["Red Salmon Matte","#ff875f"],["Red Coral Light","#ff8787"],["Red Violet Pale","#ff87af"],["Magenta Purple Orchid Light","#ff87d7"],["Magenta Purple Orchid Dark","#ff87ff"],["Orange Bright","#ffaf00"],["Orange Tangerine","#ffaf5f"],["Orange Light Salmon","#ffaf87"],["Red Pink Light","#ffafaf"],["Red Pink Medium","#ffafd7"],["Magenta Plum Bright","#ffafff"],["Yellow Gold","#ffd700"],["Yellow Gold Bright","#ffd75f"],["Yellow Gold Matte","#ffd787"],["Red Pink White","#ffd7af"],["Red Misty Rose Light","#ffd7d7"],["Magenta Thistle Bright","#ffd7ff"],["Yellow Bright","#ffff00"],["Yellow Canary Medium","#ffff5f"],["Yellow Khaki Light","#ffff87"],["Yellow Wheat","#ffffaf"],["Yellow Wheat Light","#ffffd7"],["Grey White","#ffffff"],["Grey Almost Black","#080808"],["Black Midnight","#121212"],["Black Ebony","#1c1c1c"],["Black Matte","#262626"],["Black Raven","#303030"],["Black Licorice","#3a3a3a"],["Black Jet","#444444"],["Black Onyx","#4e4e4e"],["Grey Silver","#585858"],["Grey Silver Alt","#626262"],["Grey Silver Light","#6c6c6c"],["Grey Silver Lighter","#767676"],["Grey","#808080"],["Grey Silver Matte","#8a8a8a"],["Black Flat","#949494"],["Grey Dark Slate","#9e9e9e"],["Grey Slightly Dark Slate","#a8a8a8"],["Grey Slate Alt","#b2b2b2"],["Grey Slate","#bcbcbc"],["Grey Charcoal","#c6c6c6"],["Grey Light Alt","#d0d0d0"],["Grey Light","#dadada"],["Grey Very Light","#e4e4e4"],["White Silver","#eeeeee"] ];
function colorBuild(){
		const colorPalette = document.getElementById('colorPalette');
const searchQuery=document.getElementById('searchBar').value.toLowerCase(); if(searchQuery!=""){colorPalette.innerHTML=""}
		for (const code in colorDict) {
		    if (code == 0) { } else {lower=colorDict[code][0].toLowerCase();
if(searchQuery!=""){if(!lower.includes(searchQuery)){}else{colorBuilder(colorPalette,code)}}
else{colorBuilder(colorPalette,code)}
		    }
		}
}
function colorBuilder(colorPalette,code){
			const colorName = colorDict[code][1];
			const colorDiv = document.createElement('button');
			colorDiv.classList.add('color');
			colorDiv.style.backgroundColor = colorName;
			colorDiv.title = colorDict[code][0];
			colorDiv.setAttribute("tabindex","0");
			colorDiv.addEventListener('click', function () {applyColor(colorDict[code][0], parseInt(code));});
			colorPalette.appendChild(colorDiv);

}
		const textInput = document.getElementById('textInput');

		function applyColor(color, code) {
			const selectionStart = textInput.selectionStart;
			const selectionEnd = textInput.selectionEnd;
			const text = textInput.value;

			if (selectionStart !== selectionEnd) {
				const selectedText = text.slice(selectionStart, selectionEnd);
				if (code == 16 || code == 232) { 
				    realText = newText = text.slice(0, selectionStart) + `(bright)${selectedText}(normal)` + text.slice(selectionEnd);
				} else { 
				    realText = text.slice(0, selectionStart) + `(${color})${selectedText}(normal)` + text.slice(selectionEnd);}
			} else {
				// If no text is selected, insert the color code at the cursor position
				if (code == 16 || code == 232) { 
				    realText = text.slice(0, selectionStart) + `(bright)(normal)` + text.slice(selectionStart);
				} else { 
				    realText = text.slice(0, selectionStart) + `(${color})(normal)` + text.slice(selectionStart); 
				}
			}
			textInput.value = realText;updateOutput();
			// Set cursor position after the inserted color code
			const newCursorPosition = selectionStart + (color.toString().length + 2);
			textInput.setSelectionRange(newCursorPosition, newCursorPosition);
			textInput.focus();
		}
      const regex = /(\%\(\d{1,3}\))|(\%normal)|(\%bright)|([\s\S])/g;

      function renderXterm(text) {
        let output = "";
        let currentColor = "#aaa";
        let lines = [];
        let currentLine = "";
        text.replace(regex, (match, colorCode, normal, bright, textContent) => {
          if (colorCode) {
            if (colorCode.startsWith("%(")) {
              const lily = colorCode.slice(2, -1); 
              const idx = parseInt(lily);//console.log(colorCode,idx)
              currentColor = xtermToRgbHex(idx);
            } 
          } else if (normal) { currentLine += ""; currentColor = "#aaa";
          } else if (bright) { currentLine += ""; currentColor = "#ffffff";
          } else if (textContent) {
            if (textContent === "\n") {
              lines.push({ content: currentLine });
              currentLine = "";
            } else {
              if (/\s/.test(textContent)) { currentLine += escapeHtml(textContent);
              } else { currentLine += `<span style="color: ${currentColor}">${escapeHtml(textContent)}</span>`; }
            }
          }
        });
        // Add the last line if it has content
        if (currentLine) {lines.push({ content: currentLine });}
        // Build the output with line character counts
        lines.forEach(line => {
            if (line.content == "") {output += `<div style="position: relative;"><span> </span></div>`;
            } else {output += `<div style="position: relative;">${line.content}</div>`;}
        });
        return output;
      }
      
      function updateOutput(coloredText) {
        const textToRender = cleanText(document.getElementById("textInput").value);
        document.getElementById("output").innerHTML = renderXterm(textToRender); }
      
      function xtermToRgbHex(colorIndex) {return colorDict[colorIndex][1];}
      function escapeHtml(text) {
        const map = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#039;" };
        return text.replace(/[&<>"']/g, function (m) {return map[m];}); }
        
      copyText="";
      function cleanText(text){
          billy=text
          changesNeeded=text.match(/(\(.+?\))/g)
          for (i in changesNeeded) {
              change=getColor(changesNeeded[i]);
              billy=billy.replace(changesNeeded[i],change) }
          copyText=billy;
          return billy
      }

      function getColor(text){
          if (text == "(normal)"){return "%normal"}
          if (text == "(bright)"){return "%bright"}
          colorName = text.match(/\((.+?)\)/)
          colory=colorDict.flat();//console.log(colory)
          names=colory.filter((word) => !word.includes("#"));
          colorCode = names.indexOf(colorName[1]);
          return "%("+colorCode+")";
      }
      
      function copy() {navigator.clipboard.writeText(copyText);}
      document.querySelector("#copy").addEventListener("click", copy);
      document.querySelector("#convert").addEventListener("click", convertText);
      function convertText(){
          billy=textInput.value;
          //console.log("billy",billy)
          changesNeeded=billy.match(/(\%.+?(\)|l|t))/g)
          //console.log("changesNeeded",changesNeeded)
          for (i in changesNeeded) {
              change=convertColor(changesNeeded[i]);//console.log("change",change)
              billy=billy.replace(changesNeeded[i],change); }
          textInput.value = billy; updateOutput();
      }

      function convertColor(text){
          if (text == "%normal"){return "(normal)"}
          if (text == "%bright"){return "(bright)"}
          colorName = text.match(/(\d+)/);//console.log("convertColor text",text);console.log("convertColor colorName",colorName)
          colorCode = colorDict[colorName[0]][0];
          return "("+colorCode+")";
      }
      </script>
  </body>
</html>
